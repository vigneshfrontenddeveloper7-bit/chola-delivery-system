<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Chola Delivery Letter</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
font-family:"Times New Roman", serif;
background:#f4f4f4;
padding:20px;
}

input, textarea{
width:100%;
padding:8px;
margin-bottom:10px;
}

button{
padding:10px 20px;
background:#0033cc;
color:white;
border:none;
cursor:pointer;
margin-right:10px;
}

#letter{
display:none;
width:794px;      /* A4 width */
min-height:1123px; /* A4 height */
margin:auto;
background:white;
padding:70px;
position:relative;
box-sizing:border-box;
}

/* Logo */
.logo{
position:absolute;
top:50px;
left:70px;
width:90px;
}

/* Company */
.company{
text-align:center;
font-size:18px;
font-weight:bold;
}

.title{
text-align:center;
font-weight:bold;
margin-top:5px;
}

/* Date */
.date{
position:absolute;
top:120px;
right:70px;
font-size:14px;
}

/* Seal */
.seal{
position:absolute;
bottom:240px;
right:90px;
width:130px;
height:130px;
border-radius:50%;
border:4px solid #0033cc;
display:flex;
align-items:center;
justify-content:center;
}

.inner-circle{
position:absolute;
width:95px;
height:95px;
border-radius:50%;
border:3px solid #0033cc;
display:flex;
align-items:center;
justify-content:center;
}

.seal-logo{
width:45px;
}

.circular-text span{
position:absolute;
left:50%;
font-size:11px;
font-weight:bold;
color:#0033cc;
transform-origin:0 65px;
}

/* Yours Faithfully */
.yours{
position:absolute;
bottom:290px;
right:90px;
}

/* Employee Box */
.employee-box{
position:absolute;
bottom:100px;
left:70px;
border:1px solid black;
padding:15px;
width:280px;
font-size:14px;
}
</style>
</head>

<body>

<h2>Chola Delivery Letter Generator</h2>

<input id="name" placeholder="Customer Name">
<textarea id="address" placeholder="Address"></textarea>
<input id="model" placeholder="Product / Vehicle Model">
<input id="price" placeholder="Price">
<input id="initial" placeholder="Initial Payment">
<input id="disbursement" placeholder="Disbursement Amount">

<button onclick="viewLetter()">View Letter</button>
<button onclick="downloadPDF()">Download PDF</button>

<br><br>

<div id="letter">

<img src="logo.png" class="logo">

<div class="company">
CHOLAMANDALAM INVESTMENT & FINANCE COMPANY LTD
</div>

<div class="title">
DELIVERY LETTER ORDER
</div>

<div class="date" id="autoDate"></div>

<br><br><br>

<p><b>To</b></p>
<p id="vName"></p>
<p id="vAddress"></p>

<br>

<p><b>Sub:</b> Vehicle / Product releasing order</p>

<p>Dear Sir / Madam,</p>

<p>
We Have Approved a Two-Wheeler Loan / Consumer Durable Loan for the Captioned Customer and Details are as below.
</p>

<p>Product / Vehicle Model : <span id="vModel"></span></p>
<p>Price : <span id="vPrice"></span></p>
<p>Initial Payment : <span id="vInitial"></span></p>
<p>Disbursement Amount : <span id="vDisbursement"></span></p>

<br><br>

<p>Thanking You</p>

<div class="yours">
Yours Faithfully
</div>

<!-- Seal -->
<div class="seal">
<div class="inner-circle">
<img src="logo.png" class="seal-logo">
</div>
<div id="circleText"></div>
</div>

<!-- Employee Box -->
<div class="employee-box">
<b>EMP NAME:</b> J.VIGNESH<br>
<b>EMP CODE:</b> CB100012<br>
<b>BRANCH:</b> VIRUDHACHALAM
</div>

</div>

<script>

/* View Letter */
function viewLetter(){
document.getElementById("letter").style.display="block";

vName.innerText = name.value;
vAddress.innerText = address.value;
vModel.innerText = model.value;
vPrice.innerText = price.value;
vInitial.innerText = initial.value;
vDisbursement.innerText = disbursement.value;
}

/* Download PDF */
function downloadPDF(){
const element = document.getElementById("letter");
html2pdf().from(element).set({
margin:10,
filename:'Chola_Delivery_Letter.pdf',
html2canvas:{scale:2},
jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
}).save();
}

/* Auto Date */
function formatDate(){
const today = new Date();
const day = String(today.getDate()).padStart(2,'0');
const month = String(today.getMonth()+1).padStart(2,'0');
const year = today.getFullYear();
return day + "/" + month + "/" + year;
}
document.getElementById("autoDate").innerText = "Date: " + formatDate();

/* Circular Stamp Text */
function createCircularText(text){
const container = document.getElementById("circleText");
container.innerHTML="";
for(let i=0;i<text.length;i++){
const span = document.createElement("span");
span.innerText = text[i];
const angle = i * (360/text.length);
span.style.transform =
`rotate(${angle}deg) translate(0,-60px)`;
container.appendChild(span);
}
}
createCircularText("CHOLAMANDALAM FINANCE VIRUDHACHALAM");

</script>

</body>
</html>
